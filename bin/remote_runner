#!/usr/bin/env ruby
require File.join( File.dirname(__FILE__), '..', 'lib', 'remote_runner' )

# TODO: this is crap just for testing

if File.exists?("~/.remote_runner/config")
  file = "~/.remote_runner/config"
end

file_index = 0
if ARGV.count > 1
  file_index = 1
end

file = ARGV[file_index]

unless file
  abort "no configuration file found"
end

remote_runner = RemoteRunner.new
remote_runner.load_config file

if ARGV[0] and file_index != 0
  remote_runner.configure do |c|
    c.command = ARGV[0]
  end
end

remote_runner.run

